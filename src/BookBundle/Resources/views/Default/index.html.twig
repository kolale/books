{% extends 'base.html.twig' %}

{% block body %}

    {% set auth = is_granted('IS_AUTHENTICATED_FULLY') %}

    {% if auth %}
        logged as: {{app.user.username}}; 
        <a href="{{path('fos_user_security_logout')}}">logout</a>

        <br><br>
        <a href="{{path('edit', {'id': 0})}}">Добавить книгу</a>

    {% else %}
        <a href="/login">log in</a>
    {% endif%}

    <br><br>

    {% block books_list %}
        {% for book in books %}
            {{book.id}}; 
            {{book.title}}; 
            {{book.author}}; 
            {{book.readDate is empty ? "" : book.readDate|date('Y-m-d')}}; 
            {{book.coverPath}}; 
            {{book.coverSrcPath}}; 
            <input type="checkbox" disabled
                {% if book.downloadEnabled %} checked {% endif %}
            >
            
            {% if auth %}
                <br><a href="{{path('edit', {'id': book.id})}}">Редактировать книгу</a>
                &nbsp;&nbsp;<a href="{{path('delete', {'id': book.id})}}">Удалить книгу</a>
            {% endif %}
            <br><br>
        {% else %}
            <p>Нет книг для отображения</p>
        {% endfor %}
    {% endblock %}

{% endblock %}
